<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interview Practice</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link id="dyslexicStylesheet" rel="stylesheet" href="">
    <link id="themeStylesheet" rel="stylesheet" href="../static/styles.css">
</head>
<body>
    <div id="loadingOverlay">
        <div class="spinner"></div>
      </div>
    
    <nav class="navbar navbar-expand-lg shadow-sm sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="{{url_for('index')}}" aria-label="interview practice">Interview Practice</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link fw-semibold" href="{{url_for('index')}}" aria-label="home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-semibold" href="{{url_for('advice')}}" aria-label="advice">Advice</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-semibold" href="{{url_for('results')}}" aria-label="results">Results</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-semibold" href="{{url_for('help')}}" aria-label="help">Help</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

<div class="mt-4"></div>

<div class="container">
    <div class="row">
        <div class="col">
            <h2 class="mb-3 text-center" aria-label="record your interview">Record Your Interview</h2>
            <div class="interview-box p-3 w-100">
                <div class="video-container">
                    <video id="videoElement" autoplay class="w-100"></video>
                </div>
            </div>
        </div>

        <div class="col justify-content-center align-items-center right-panel">
            <div class="d-flex quote-box mb-3 h-25 justify-content-center align-items-center">
                <!-- Active question text will appear here -->
                <p id="questionText">"Please select a question"</p>
            </div>
            <div class="d-flex justify-content-center align-items-center gap-3">
                <button id="questionButton" class="btn btn-primary mb-2">Next Question</button>
                <button id="chooseQuestionButton" class="btn btn-primary mb-2" onclick="window.location.href='/questions'">Choose Question</button>
            </div>
            <div class="text-center mt-2">
                <div aria-label="prep time remaining">Prep Time Remaining:</div>
                <div id="prepTimer">0:00</div>
                <div aria-label="record time remaining">Record Time Remaining:</div>
                <div id="recordTimer">0:00</div>
            </div>
            <div class="form-group mt-3">
                <textarea class="form-control notes" rows="7" placeholder="Quick Notes..."></textarea>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  
// Load the active question from localStorage if available
window.addEventListener('load', () => {
    const activeQuestion = localStorage.getItem('activeQuestion');
    if (activeQuestion) {
        const { id, text, prep, time } = JSON.parse(activeQuestion);
        // Update the question text
        document.getElementById('questionText').innerText = text;
        // Optionally, start the timers automatically if an active question is present:
        //updateCounter(recordTimer, time);  // Update record timer display immediately
        //startCountdown(prepTimer, prep, () => onPrepEnd(time));
    } else {
        document.getElementById('questionText').innerText = '"Please select a question"';
    }
});


// Function to handle the "Next Question" button click
// document.getElementById("questionButton").addEventListener("click", async () => {
//     try {
//         const response = await fetch("/api/get-next-question");
//         const data = await response.json();
//         if (response.ok && data.text) {
//             // Update the active question on the page
//             document.getElementById("questionText").innerText = data.text;

//             // Store the active question in localStorage
//             localStorage.setItem('activeQuestion', JSON.stringify({ id: data.id, text: data.text }));
//         } else {
//             alert('No questions available.');
//         }
//     } catch (error) {
//         console.error("Error fetching the next question:", error);
//     }
// });
</script>

<script src="../static/script.js"></script>

<script src="../static/darkdyslexic.js"></script>
</body>
</html>
